{"componentChunkName":"component---src-templates-post-template-jsx","path":"/posts/zabbix-mysql-key","webpackCompilationHash":"adfe64856e04346669a5","result":{"data":{"site":{"siteMetadata":{"title":"dongjinjo","subtitle":"Blog by dongjinjo","copyright":"© All rights reserved.","menu":[{"label":"Articles","path":"/"},{"label":"Categories","path":"/categories/"},{"label":"Tags","path":"/tags/"}],"author":{"name":"dongjin jo","twitter":"#"},"disqusShortname":"dongjinjo","url":"https://dongjinjo.github.io"}},"markdownRemark":{"id":"86a39a4b-2e0c-54e1-8562-2644a75fa995","html":"<blockquote>\n<p>Zabbix의 MySQL용 Key 생성 및 Item 설정 방법</p>\n</blockquote>\n<h2>MySQL 인증 설정</h2>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># /var/lib/zabbix/.my.cnf</span>\n<span class=\"token punctuation\">[</span>mysql<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">user</span><span class=\"token operator\">=</span><span class=\"token string\">''</span>\n<span class=\"token assign-left variable\">password</span><span class=\"token operator\">=</span><span class=\"token string\">''</span>\n<span class=\"token assign-left variable\">host</span><span class=\"token operator\">=</span><span class=\"token string\">'ip addr'</span>\n\n<span class=\"token punctuation\">[</span>mysqladmin<span class=\"token punctuation\">]</span>\n<span class=\"token assign-left variable\">user</span><span class=\"token operator\">=</span><span class=\"token string\">''</span>\n<span class=\"token assign-left variable\">password</span><span class=\"token operator\">=</span><span class=\"token string\">''</span>\n<span class=\"token assign-left variable\">host</span><span class=\"token operator\">=</span><span class=\"token string\">'ip addr'</span></code></pre></div>\n<h2>UserParameter.conf 추가</h2>\n<p>userParameter_mysql.conf</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token assign-left variable\">UserParameter</span><span class=\"token operator\">=</span>mysql.status<span class=\"token punctuation\">[</span>*<span class=\"token punctuation\">]</span>,echo <span class=\"token string\">\"show global status where Variable_name='<span class=\"token variable\">$1</span>';\"</span> <span class=\"token operator\">|</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">HOME</span></span><span class=\"token operator\">=</span>/var/lib/zabbix mysql -N <span class=\"token operator\">|</span> <span class=\"token function\">awk</span> <span class=\"token string\">'{print <span class=\"token variable\">$$</span>2}'</span>\n\n<span class=\"token assign-left variable\">UserParameter</span><span class=\"token operator\">=</span>mysql.size<span class=\"token punctuation\">[</span>*<span class=\"token punctuation\">]</span>,bash -c <span class=\"token string\">'echo \"select sum(<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token keyword\">case</span> <span class=\"token string\">\"<span class=\"token variable\">$3</span>\"</span> <span class=\"token keyword\">in</span> both<span class=\"token operator\">|</span><span class=\"token string\">\"\"</span><span class=\"token variable\">)</span></span> echo \"data_length+index_length\";; data|index) echo \"<span class=\"token variable\">$3_length</span>\";; free) echo \"data_free\";; esac)) from information_schema.tables<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"all\"</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span> <span class=\"token string\">\"<span class=\"token variable\">$1</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\" where table_schema=<span class=\"token entity\" title=\"\\&quot;\">\\\"</span><span class=\"token variable\">$1</span><span class=\"token entity\" title=\"\\&quot;\">\\\"</span>\"</span><span class=\"token variable\">)</span></span><span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\">$2</span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"all\"</span> <span class=\"token operator\">||</span> <span class=\"token operator\">!</span> <span class=\"token string\">\"<span class=\"token variable\">$2</span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"and table_name=<span class=\"token entity\" title=\"\\&quot;\">\\\"</span><span class=\"token variable\">$2</span><span class=\"token entity\" title=\"\\&quot;\">\\\"</span>\"</span><span class=\"token variable\">)</span></span>;\" | HOME=/var/lib/zabbix mysql -N'</span>\n\n<span class=\"token assign-left variable\">UserParameter</span><span class=\"token operator\">=</span>mysql.version,mysql -V\n<span class=\"token assign-left variable\">UserParameter</span><span class=\"token operator\">=</span>mysql.ping,<span class=\"token environment constant\">HOME</span><span class=\"token operator\">=</span>/var/lib/zabbix mysqladmin <span class=\"token function\">ping</span> <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> -c alive</code></pre></div>\n<h2>Item Key 설정 값</h2>\n<table>\n<thead>\n<tr>\n<th>name</th>\n<th>key</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>status</td>\n<td>mysql.ping</td>\n</tr>\n<tr>\n<td>bytes received per second</td>\n<td>mysql.status[bytes_received]</td>\n</tr>\n<tr>\n<td>bytes sent per second</td>\n<td>mysql.status[bytes_sent]</td>\n</tr>\n<tr>\n<td>begin operations per second</td>\n<td>mysql.status[com_begin]</td>\n</tr>\n<tr>\n<td>commit operations per second</td>\n<td>mysql.status[com_commit]</td>\n</tr>\n<tr>\n<td>delete operations per second</td>\n<td>mysql.status[com_delete]</td>\n</tr>\n<tr>\n<td>insert operations per second</td>\n<td>mysql.status[com_insert]</td>\n</tr>\n<tr>\n<td>rollback operations per second</td>\n<td>mysql.status[com_rollback]</td>\n</tr>\n<tr>\n<td>select operations per second</td>\n<td>mysql.status[com_select]</td>\n</tr>\n<tr>\n<td>update operations per second</td>\n<td>mysql.status[com_update]</td>\n</tr>\n<tr>\n<td>queries per second</td>\n<td>mysql.status[questions]</td>\n</tr>\n<tr>\n<td>slow queries</td>\n<td>mysql.status[slow_queries]</td>\n</tr>\n<tr>\n<td>uptime</td>\n<td>mysql.status[uptime]</td>\n</tr>\n<tr>\n<td>version</td>\n<td>mysql.version</td>\n</tr>\n<tr>\n<td>disk used(%)</td>\n<td>vfs.fs.size[/var/lib/mysql</td>\n</tr>\n</tbody>\n</table>","fields":{"categorySlug":"/categories/zabbix/","tagSlugs":["/tags/zabbix/","/tags/mysql/","/tags/monitoring/"],"slug":"/posts/zabbix-mysql-key"},"frontmatter":{"title":"MySQL Key 생성 및 Item 설정","tags":["zabbix","mysql","monitoring"],"date":"2018-09-04T00:00:00.000Z","category":"zabbix","description":""}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/posts/zabbix-mysql-key"}}}